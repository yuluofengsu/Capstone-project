# 3.3 数据库设计

## 3.3.1 概念结构设计

数据库是系统开发的重要环节。从需求分析阶段的用例分析中可以得到用户、图书、分类、标签、评论、借阅记录、社区帖子、阅读活动、地址、广告、横幅、公告十二个实体。下面给出对应实体属性图。

### 1. 用户实体

用户实体是图书借阅推荐系统的核心实体之一,包括用户编号、用户名、密码、角色、账号状态、昵称、头像、手机号、邮箱、性别、个人简介、创建时间、积分、推送邮箱、推送开关、管理员令牌、用户令牌十七个属性。用户分为管理员和普通用户两种角色,管理员负责系统管理和内容审核,普通用户可以浏览图书、借阅图书、发布评论和参与社区互动。用户账号状态包括正常和封号两种状态,方便管理员对违规用户进行管理。用户积分用于记录用户的活跃度和贡献值。

用户实体属性图如图3-1所示。

### 2. 图书实体

图书实体是系统的核心资源实体,包括图书编号、图书分类编号、图书标题、原始标题、封面图片、作者、译者、图书简介、出版社、页数、价格、ISBN编号、出版日期、上架时间、图书状态、库存量、评分、装帧类型、创建时间、浏览量、推荐次数、想看人数、收藏人数二十三个属性。图书状态包括上架和下架两种状态,便于管理员控制图书的展示。图书评分和浏览量等统计数据用于推荐算法的计算。图书可以关联多个标签,形成多对多关系,便于用户根据兴趣进行筛选。图书的想看和收藏功能允许用户标记感兴趣的图书,系统可以根据这些数据为用户提供个性化推荐。

图书实体属性图如图3-2所示。

### 3. 分类实体

分类实体用于组织图书的分类体系,包括分类编号、父分类编号、分类名称、创建时间四个属性。分类采用树形结构设计,通过父分类编号字段实现分类的层级关系。系统支持多级分类,顶级分类的父编号为-1。分类体系包括小说、文学、经济学、漫画、动漫、计算机、财经、科技、历史、教育、生活、娱乐等多个大类,每个大类下可以继续细分子类别,形成完整的图书分类体系。

分类实体属性图如图3-3所示。

### 4. 标签实体

标签实体用于对图书进行更灵活的标记和分类,包括标签编号、标签名称、创建时间三个属性。与分类不同,标签是一种扁平化的组织方式,一本图书可以拥有多个标签,一个标签也可以关联多本图书,形成多对多关系。标签可以描述图书的风格、主题、适读人群等多维度特征,比如"推理"、"治愈"、"青春"、"历史"等。用户可以通过标签快速找到同类型的图书,系统也可以基于标签进行相似图书的推荐。

标签实体属性图如图3-4所示。

### 5. 评论实体

评论实体记录用户对图书的评价信息,包括评论编号、评论内容、用户编号、图书编号、评论时间、点赞数六个属性。用户在阅读图书后可以发表自己的看法和感受,帮助其他用户了解图书质量和内容特点。评论支持点赞功能,优质评论可以获得更多关注。评论时间按照发布时间倒序排列,方便用户查看最新评价。系统管理员可以对不当评论进行审核和删除,维护良好的社区环境。

评论实体属性图如图3-5所示。

### 6. 借阅记录实体

借阅记录实体记录用户借阅图书的完整过程,包括借阅编号、用户编号、图书编号、借阅状态、借阅时间、应还时间、实际归还时间、是否延期八个属性。借阅状态分为借出和已还两种,方便统计图书的流转情况。系统记录应还时间和实际归还时间,可以计算逾期天数并提醒用户及时归还。延期标志用于标记需要延长借阅期限的记录。借阅记录是推荐算法的重要数据来源,系统可以根据用户的借阅历史推荐相似图书。

借阅记录实体属性图如图3-6所示。

### 7. 借阅日志实体

借阅日志实体记录借阅过程中的操作行为,包括日志编号、用户编号、图书编号、操作类型、日志时间五个属性。操作类型包括借书、还书、续借等行为,记录借阅的完整流程。借阅日志为系统提供审计追踪功能,便于统计分析和问题排查。日志数据可以用于生成借阅趋势报表,帮助图书馆了解图书的流通情况和热门程度。

借阅日志实体属性图如图3-7所示。

### 8. 社区帖子实体

社区帖子实体支持用户在平台上进行交流互动,包括帖子编号、帖子标题、帖子内容、发布用户编号、发布时间、浏览量、点赞数七个属性。用户可以发表读书心得、推荐好书、讨论书评等内容,形成活跃的阅读社区。帖子支持点赞功能,通过点赞数可以筛选优质内容。浏览量统计可以了解帖子的受欢迎程度。系统通过社区帖子增强用户粘性,促进用户之间的交流和互动。

社区帖子实体属性图如图3-8所示。

### 9. 社区评论实体

社区评论实体用于记录用户对社区帖子或阅读活动的评论,包括评论编号、评论内容、用户编号、帖子编号、活动编号、评论时间、点赞数七个属性。社区评论可以关联到社区帖子或阅读活动,其中帖子编号和活动编号为可选字段,通过外键约束确保数据关联的正确性。用户可以对感兴趣的帖子或活动发表看法,形成深度讨论。评论支持点赞功能,鼓励优质内容的产生。

社区评论实体属性图如图3-9所示。

### 10. 阅读活动实体

阅读活动实体用于组织线上或线下的阅读推广活动,包括活动编号、活动标题、活动描述、活动封面、开始时间、结束时间、创建时间、活动状态八个属性。活动状态分为未开始、进行中、已结束三种,便于系统自动更新活动展示。活动描述详细介绍活动内容、参与方式、奖励规则等信息。活动封面图片用于吸引用户关注。系统通过举办各类阅读活动,提升用户参与度,培养良好的阅读习惯。

阅读活动实体属性图如图3-10所示。

### 11. 地址实体

地址实体记录用户的收货地址信息,包括地址编号、用户编号、收货人姓名、联系电话、详细地址、是否默认地址、创建时间七个属性。用户可以保存多个收货地址,便于借阅图书的邮寄配送。默认地址标志用于快速选择常用地址。地址信息在用户借阅需要配送的图书时使用,提升用户体验。

地址实体属性图如图3-11所示。

### 12. 浏览记录实体

浏览记录实体用于记录用户浏览图书的历史,包括记录编号、用户编号、图书编号、图书标题、图书分类编号、浏览时间六个属性。浏览记录是推荐系统的重要数据源,系统可以分析用户的浏览偏好,推荐相关图书。浏览历史帮助用户快速找到之前看过的图书,提升使用体验。

浏览记录实体属性图如图3-12所示。

### 13. 公告实体

公告实体用于发布系统通知和重要信息,包括公告编号、公告标题、公告内容、创建时间四个属性。管理员可以发布图书推荐、活动通知、系统维护等各类公告。公告在首页显著位置展示,确保用户及时获取重要信息。公告内容支持富文本格式,可以插入图片和链接,提供更丰富的信息展示。

公告实体属性图如图3-13所示。

### 14. 横幅实体

横幅实体用于在系统首页展示重点推荐的图书,包括横幅编号、横幅图片、关联图书编号、创建时间四个属性。横幅通过精美的图片设计吸引用户点击,每个横幅关联一本精选图书。管理员可以根据运营需求更换横幅内容,突出展示新书、热门书或主题图书,提升图书的曝光度和借阅量。

横幅实体属性图如图3-14所示。

### 15. 广告实体

广告实体用于在系统中展示推广信息,包括广告编号、广告图片、链接地址、创建时间四个属性。广告可以跳转到外部网站或系统内部页面,支持图书出版社、作者活动等内容的宣传推广。管理员可以灵活配置广告内容和跳转链接,实现商业价值的转化。广告图片需要设计醒目但不影响用户正常浏览体验。

广告实体属性图如图3-15所示。

### 实体关系描述

上面给出了图书借阅推荐系统的各个实体,下面将分析实体与实体之间的关系,内容如下:

1. **用户与图书构成多对多关系**：用户可以借阅多本图书,一本图书可以被多个用户借阅。通过借阅记录实体关联用户和图书。

2. **用户与图书形成多对多收藏关系**：用户可以收藏多本图书,一本图书可以被多个用户收藏。图书实体中通过ManyToMany字段直接关联用户。

3. **用户与图书形成多对多想看关系**：用户可以将多本图书加入想看列表,一本图书可以被多个用户标记想看。

4. **用户与评论呈一对多关系**：一个用户可以发表多条评论,每条评论仅属于一个用户。

5. **图书与评论呈一对多关系**：一本图书可以有多条评论,每条评论仅针对一本图书。

6. **用户与社区帖子呈一对多关系**：一个用户可以发布多个帖子,每个帖子仅属于一个用户。

7. **用户与社区评论呈一对多关系**：一个用户可以发表多条社区评论,每条评论仅属于一个用户。

8. **社区帖子与社区评论呈一对多关系**：一个帖子可以有多条评论,每条评论仅针对一个帖子或活动。

9. **阅读活动与社区评论呈一对多关系**：一个活动可以有多条评论,每条评论可以关联一个活动。

10. **用户与地址呈一对多关系**：一个用户可以有多个收货地址,每个地址仅属于一个用户。

11. **图书与分类呈多对一关系**：一本图书属于一个分类,一个分类下可以有多本图书。

12. **图书与标签呈多对多关系**：一本图书可以有多个标签,一个标签可以关联多本图书。

13. **用户与借阅记录呈一对多关系**：一个用户可以有多条借阅记录,每条记录仅属于一个用户。

14. **图书与借阅记录呈一对多关系**：一本图书可以有多条借阅记录,每条记录仅关联一本图书。

15. **用户与浏览记录呈一对多关系**：一个用户可以有多条浏览记录,每条记录仅属于一个用户。

16. **图书与浏览记录呈一对多关系**：一本图书可以有多条浏览记录,每条记录仅关联一本图书。

17. **图书与横幅呈一对多关系**：一本图书可以关联多个横幅,每个横幅仅展示一本图书。

18. **社区帖子与点赞用户呈多对多关系**：一个帖子可以被多个用户点赞,一个用户可以点赞多个帖子。

19. **用户与借阅日志呈一对多关系**：一个用户可以有多条借阅日志,每条日志仅属于一个用户。

20. **图书与借阅日志呈一对多关系**：一本图书可以有多条借阅日志,每条日志仅关联一本图书。

针对上述实体之间的关系,系统E-R图展示了各实体的完整关联结构,如图3-16所示。

## 3.3.2 逻辑结构设计

经过上面的分析与设计已经得出了初步的E-R图,接下来将根据E-R图设计逻辑结构,内容如下,其中属性有<u>**双下划线**</u>的为主键,<u>单下划线</u>的为外键。

1. **用户**（<u>**用户编号**</u>，用户名，密码，角色，账号状态，昵称，头像，手机号，邮箱，性别，个人简介，创建时间，积分，推送邮箱，推送开关，管理员令牌，用户令牌）

2. **图书**（<u>**图书编号**</u>，<u>分类编号</u>，图书标题，原始标题，封面图片，作者，译者，图书简介，出版社，页数，价格，ISBN编号，出版日期，上架时间，图书状态，库存量，评分，装帧类型，创建时间，浏览量，推荐次数，想看人数，收藏人数）

3. **分类**（<u>**分类编号**</u>，父分类编号，分类名称，创建时间）

4. **标签**（<u>**标签编号**</u>，标签名称，创建时间）

5. **图书标签关系**（<u>**关系编号**</u>，<u>图书编号</u>，<u>标签编号</u>）

6. **评论**（<u>**评论编号**</u>，<u>用户编号</u>，<u>图书编号</u>，评论内容，评论时间，点赞数）

7. **借阅记录**（<u>**借阅编号**</u>，<u>用户编号</u>，<u>图书编号</u>，借阅状态，借阅时间，应还时间，实际归还时间，是否延期）

8. **借阅日志**（<u>**日志编号**</u>，<u>用户编号</u>，<u>图书编号</u>，操作类型，日志时间）

9. **社区帖子**（<u>**帖子编号**</u>，<u>用户编号</u>，帖子标题，帖子内容，发布时间，浏览量，点赞数）

10. **社区评论**（<u>**评论编号**</u>，<u>用户编号</u>，<u>帖子编号</u>，<u>活动编号</u>，评论内容，评论时间，点赞数）

11. **阅读活动**（<u>**活动编号**</u>，活动标题，活动描述，活动封面，开始时间，结束时间，创建时间，活动状态）

12. **地址**（<u>**地址编号**</u>，<u>用户编号</u>，收货人姓名，联系电话，详细地址，是否默认地址，创建时间）

13. **浏览记录**（<u>**记录编号**</u>，<u>用户编号</u>，<u>图书编号</u>，图书标题，<u>分类编号</u>，浏览时间）

14. **图书收藏关系**（<u>**关系编号**</u>，<u>图书编号</u>，<u>用户编号</u>）

15. **图书想看关系**（<u>**关系编号**</u>，<u>图书编号</u>，<u>用户编号</u>）

16. **帖子点赞关系**（<u>**关系编号**</u>，<u>帖子编号</u>，<u>用户编号</u>）

17. **公告**（<u>**公告编号**</u>，公告标题，公告内容，创建时间）

18. **横幅**（<u>**横幅编号**</u>，<u>图书编号</u>，横幅图片，创建时间）

19. **广告**（<u>**广告编号**</u>，广告图片，链接地址，创建时间）

20. **登录日志**（<u>**日志编号**</u>，用户名，IP地址，用户代理，登录时间）

21. **操作日志**（<u>**日志编号**</u>，请求IP，请求时间，请求URL，请求方法，请求内容，访问耗时）

22. **错误日志**（<u>**日志编号**</u>，IP地址，请求URL，请求方法，错误内容，日志时间）

## 3.3.3 表结构设计

根据上一阶段得出的优化之后的关系模式,系统一共设计出二十二张对应的数据表,下面将给出所有数据表的信息,如表3-1所示。

**表3-1 数据表概述**

| 表名 | 说明 | 功能 |
|------|------|------|
| b_user | 用户表 | 存储用户基本信息和认证信息 |
| b_book | 图书表 | 存储图书详细信息 |
| b_classification | 分类表 | 存储图书分类信息 |
| b_tag | 标签表 | 存储图书标签信息 |
| b_book_tag | 图书标签关系表 | 存储图书与标签的多对多关系 |
| b_comment | 评论表 | 存储用户对图书的评论 |
| b_borrow | 借阅记录表 | 存储图书借阅信息 |
| b_borrow_log | 借阅日志表 | 存储借阅操作日志 |
| b_community_post | 社区帖子表 | 存储用户发布的社区帖子 |
| b_community_comment | 社区评论表 | 存储社区帖子和活动的评论 |
| b_reading_event | 阅读活动表 | 存储阅读推广活动信息 |
| b_address | 地址表 | 存储用户收货地址 |
| b_record | 浏览记录表 | 存储用户浏览图书的历史记录 |
| b_book_collect | 图书收藏关系表 | 存储图书收藏的多对多关系 |
| b_book_wish | 图书想看关系表 | 存储图书想看的多对多关系 |
| b_community_post_liked_users | 帖子点赞关系表 | 存储帖子点赞的多对多关系 |
| b_notice | 公告表 | 存储系统公告信息 |
| b_banner | 横幅表 | 存储首页横幅推荐信息 |
| b_ad | 广告表 | 存储系统广告信息 |
| b_login_log | 登录日志表 | 存储用户登录日志 |
| b_op_log | 操作日志表 | 存储系统操作日志 |
| b_error_log | 错误日志表 | 存储系统错误日志 |

数据表结构具体内容如下:

### 1. 用户表

图书借阅推荐系统的用户表名称为b_user,主要记录用户的基本信息和认证信息,数据表逻辑结构如表3-2所示。

**表3-2 用户表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 用户编号 | bigint | | 主键 | 否 | 自增 |
| username | 用户名 | varchar | 50 | | 是 | |
| password | 密码 | varchar | 50 | | 是 | |
| role | 角色 | varchar | 2 | | 是 | |
| status | 账号状态 | varchar | 1 | | 是 | '0' |
| nickname | 昵称 | varchar | 20 | | 是 | |
| avatar | 头像 | varchar | 100 | | 是 | |
| mobile | 手机号 | varchar | 13 | | 是 | |
| email | 邮箱 | varchar | 50 | | 是 | |
| gender | 性别 | varchar | 1 | | 是 | |
| description | 个人简介 | text | 200 | | 是 | |
| create_time | 创建时间 | datetime | 6 | | 是 | |
| score | 积分 | int | | | 是 | 0 |
| push_email | 推送邮箱 | varchar | 40 | | 是 | |
| push_switch | 推送开关 | tinyint | 1 | | 是 | false |
| admin_token | 管理员令牌 | varchar | 32 | | 是 | |
| token | 用户令牌 | varchar | 32 | | 是 | |

### 2. 图书表

图书表名称为b_book,主要记录图书的详细信息,数据表逻辑结构如表3-3所示。

**表3-3 图书表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 图书编号 | bigint | | 主键 | 否 | 自增 |
| classification_id | 分类编号 | bigint | | 外键 | 是 | |
| title | 图书标题 | varchar | 255 | | 是 | |
| original_title | 原始标题 | varchar | 255 | | 是 | |
| cover | 封面图片 | varchar | 100 | | 是 | |
| author | 作者 | varchar | 50 | | 是 | |
| translator | 译者 | varchar | 50 | | 是 | |
| description | 图书简介 | longtext | | | 是 | |
| press | 出版社 | varchar | 50 | | 是 | |
| page_count | 页数 | int | | | 否 | 0 |
| price | 价格 | varchar | 50 | | 是 | |
| isbn | ISBN编号 | varchar | 50 | | 是 | |
| pub_date | 出版日期 | date | | | 是 | |
| online_time | 上架时间 | datetime | 6 | | 是 | |
| status | 图书状态 | varchar | 1 | | 否 | '0' |
| repertory | 库存量 | int | | | 否 | 0 |
| score | 评分 | varchar | 11 | | 否 | '0' |
| layout | 装帧类型 | varchar | 10 | | 是 | |
| create_time | 创建时间 | datetime | 6 | | 是 | |
| pv | 浏览量 | int | | | 否 | 0 |
| recommend_count | 推荐次数 | int | | | 否 | 0 |
| wish_count | 想看人数 | int | | | 否 | 0 |
| collect_count | 收藏人数 | int | | | 否 | 0 |

### 3. 分类表

分类表名称为b_classification,采用树形结构设计,数据表逻辑结构如表3-4所示。

**表3-4 分类表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 分类编号 | bigint | | 主键 | 否 | 自增 |
| pid | 父分类编号 | int | | | 是 | -1 |
| title | 分类名称 | varchar | 100 | | 是 | |
| create_time | 创建时间 | datetime | 6 | | 是 | |

### 4. 标签表

标签表名称为b_tag,数据表逻辑结构如表3-5所示。

**表3-5 标签表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 标签编号 | bigint | | 主键 | 否 | 自增 |
| title | 标签名称 | varchar | 100 | | 是 | |
| create_time | 创建时间 | datetime | 6 | | 是 | |

### 5. 图书标签关系表

图书标签关系表名称为b_book_tag,存储图书与标签的多对多关系,数据表逻辑结构如表3-6所示。

**表3-6 图书标签关系表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 关系编号 | bigint | | 主键 | 否 | 自增 |
| book_id | 图书编号 | bigint | | 外键 | 否 | |
| tag_id | 标签编号 | bigint | | 外键 | 否 | |

### 6. 评论表

评论表名称为b_comment,数据表逻辑结构如表3-7所示。

**表3-7 评论表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 评论编号 | bigint | | 主键 | 否 | 自增 |
| user_id | 用户编号 | bigint | | 外键 | 是 | |
| book_id | 图书编号 | bigint | | 外键 | 是 | |
| content | 评论内容 | varchar | 200 | | 是 | |
| comment_time | 评论时间 | datetime | 6 | | 是 | |
| like_count | 点赞数 | int | | | 否 | 0 |

### 7. 借阅记录表

借阅记录表名称为b_borrow,数据表逻辑结构如表3-8所示。

**表3-8 借阅记录表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 借阅编号 | bigint | | 主键 | 否 | 自增 |
| user_id | 用户编号 | bigint | | 外键 | 是 | |
| book_id | 图书编号 | bigint | | 外键 | 是 | |
| status | 借阅状态 | varchar | 2 | | 是 | |
| borrow_time | 借阅时间 | datetime | 6 | | 是 | |
| expect_time | 应还时间 | datetime | 6 | | 是 | |
| return_time | 实际归还时间 | datetime | 6 | | 是 | |
| delayed | 是否延期 | tinyint | 1 | | 是 | false |

### 8. 借阅日志表

借阅日志表名称为b_borrow_log,数据表逻辑结构如表3-9所示。

**表3-9 借阅日志表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 日志编号 | bigint | | 主键 | 否 | 自增 |
| user_id | 用户编号 | bigint | | 外键 | 是 | |
| book_id | 图书编号 | bigint | | 外键 | 是 | |
| action | 操作类型 | varchar | 2 | | 是 | |
| log_time | 日志时间 | datetime | 6 | | 是 | |

### 9. 社区帖子表

社区帖子表名称为b_community_post,数据表逻辑结构如表3-10所示。

**表3-10 社区帖子表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 帖子编号 | bigint | | 主键 | 否 | 自增 |
| user_id | 用户编号 | bigint | | 外键 | 是 | |
| title | 帖子标题 | varchar | 100 | | 是 | |
| content | 帖子内容 | longtext | | | 是 | |
| create_time | 发布时间 | datetime | 6 | | 是 | |
| views | 浏览量 | int | | | 否 | 0 |
| like_count | 点赞数 | int | | | 否 | 0 |

### 10. 社区评论表

社区评论表名称为b_community_comment,数据表逻辑结构如表3-11所示。

**表3-11 社区评论表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 评论编号 | bigint | | 主键 | 否 | 自增 |
| user_id | 用户编号 | bigint | | 外键 | 是 | |
| post_id | 帖子编号 | bigint | | 外键 | 是 | |
| event_id | 活动编号 | bigint | | 外键 | 是 | |
| content | 评论内容 | varchar | 500 | | 是 | |
| create_time | 评论时间 | datetime | 6 | | 是 | |
| like_count | 点赞数 | int | | | 否 | 0 |

### 11. 阅读活动表

阅读活动表名称为b_reading_event,数据表逻辑结构如表3-12所示。

**表3-12 阅读活动表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 活动编号 | bigint | | 主键 | 否 | 自增 |
| title | 活动标题 | varchar | 100 | | 是 | |
| description | 活动描述 | text | 2000 | | 是 | |
| cover | 活动封面 | varchar | 100 | | 是 | |
| start_time | 开始时间 | datetime | 6 | | 是 | |
| end_time | 结束时间 | datetime | 6 | | 是 | |
| create_time | 创建时间 | datetime | 6 | | 是 | |
| status | 活动状态 | varchar | 1 | | 否 | '0' |

### 12. 地址表

地址表名称为b_address,数据表逻辑结构如表3-13所示。

**表3-13 地址表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 地址编号 | bigint | | 主键 | 否 | 自增 |
| user_id | 用户编号 | bigint | | 外键 | 是 | |
| name | 收货人姓名 | varchar | 100 | | 是 | |
| mobile | 联系电话 | varchar | 30 | | 是 | |
| desc | 详细地址 | varchar | 300 | | 是 | |
| default | 是否默认地址 | tinyint | 1 | | 是 | false |
| create_time | 创建时间 | datetime | 6 | | 是 | |

### 14. 浏览记录表

浏览记录表名称为b_record,数据表逻辑结构如表3-14所示。

**表3-14 浏览记录表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 记录编号 | bigint | | 主键 | 否 | 自增 |
| user_id | 用户编号 | bigint | | 外键 | 是 | |
| book_id | 图书编号 | bigint | | 外键 | 是 | |
| title | 图书标题 | varchar | 100 | | 是 | |
| classification_id | 分类编号 | bigint | | 外键 | 是 | |
| record_time | 浏览时间 | datetime | 6 | | 是 | |

### 15. 图书收藏关系表

图书收藏关系表名称为b_book_collect,存储图书收藏的多对多关系,数据表逻辑结构如表3-15所示。

**表3-15 图书收藏关系表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 关系编号 | bigint | | 主键 | 否 | 自增 |
| book_id | 图书编号 | bigint | | 外键 | 否 | |
| user_id | 用户编号 | bigint | | 外键 | 否 | |

### 16. 图书想看关系表

图书想看关系表名称为b_book_wish,存储图书想看的多对多关系,数据表逻辑结构如表3-16所示。

**表3-16 图书想看关系表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 关系编号 | bigint | | 主键 | 否 | 自增 |
| book_id | 图书编号 | bigint | | 外键 | 否 | |
| user_id | 用户编号 | bigint | | 外键 | 否 | |

### 17. 帖子点赞关系表

帖子点赞关系表名称为b_community_post_liked_users,存储帖子点赞的多对多关系,数据表逻辑结构如表3-17所示。

**表3-17 帖子点赞关系表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 关系编号 | bigint | | 主键 | 否 | 自增 |
| communitypost_id | 帖子编号 | bigint | | 外键 | 否 | |
| user_id | 用户编号 | bigint | | 外键 | 否 | |

### 18. 公告表

公告表名称为b_notice,数据表逻辑结构如表3-18所示。

**表3-18 公告表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 公告编号 | bigint | | 主键 | 否 | 自增 |
| title | 公告标题 | varchar | 100 | | 是 | |
| content | 公告内容 | varchar | 1000 | | 是 | |
| create_time | 创建时间 | datetime | 6 | | 是 | |

### 19. 横幅表

横幅表名称为b_banner,数据表逻辑结构如表3-19所示。

**表3-19 横幅表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 横幅编号 | bigint | | 主键 | 否 | 自增 |
| book_id | 图书编号 | bigint | | 外键 | 是 | |
| image | 横幅图片 | varchar | 100 | | 是 | |
| create_time | 创建时间 | datetime | 6 | | 是 | |

### 20. 广告表

广告表名称为b_ad,数据表逻辑结构如表3-20所示。

**表3-20 广告表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 广告编号 | bigint | | 主键 | 否 | 自增 |
| image | 广告图片 | varchar | 100 | | 是 | |
| link | 链接地址 | varchar | 500 | | 是 | |
| create_time | 创建时间 | datetime | 6 | | 是 | |

### 21. 登录日志表

登录日志表名称为b_login_log,数据表逻辑结构如表3-21所示。

**表3-21 登录日志表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 日志编号 | bigint | | 主键 | 否 | 自增 |
| username | 用户名 | varchar | 50 | | 是 | |
| ip | IP地址 | varchar | 100 | | 是 | |
| ua | 用户代理 | varchar | 200 | | 是 | |
| log_time | 登录时间 | datetime | 6 | | 是 | |

### 22. 操作日志表

操作日志表名称为b_op_log,数据表逻辑结构如表3-22所示。

**表3-22 操作日志表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 日志编号 | bigint | | 主键 | 否 | 自增 |
| re_ip | 请求IP | varchar | 100 | | 是 | |
| re_time | 请求时间 | datetime | 6 | | 是 | |
| re_url | 请求URL | varchar | 200 | | 是 | |
| re_method | 请求方法 | varchar | 10 | | 是 | |
| re_content | 请求内容 | varchar | 200 | | 是 | |
| access_time | 访问耗时 | varchar | 10 | | 是 | |

### 23. 错误日志表

错误日志表名称为b_error_log,数据表逻辑结构如表3-23所示。

**表3-23 错误日志表**

| 字段名 | 字段说明 | 数据类型 | 长度 | 主键或外键 | 允许空值 | 默认值 |
|--------|---------|---------|------|-----------|---------|--------|
| id | 日志编号 | bigint | | 主键 | 否 | 自增 |
| ip | IP地址 | varchar | 100 | | 是 | |
| url | 请求URL | varchar | 200 | | 是 | |
| method | 请求方法 | varchar | 10 | | 是 | |
| content | 错误内容 | varchar | 200 | | 是 | |
| log_time | 日志时间 | datetime | 6 | | 是 | |
